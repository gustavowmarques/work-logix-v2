{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h4>Manage Units for {{ client.name }}</h4>

  <!-- Filter + Select All -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <input type="text" id="searchInput" class="form-control w-50 me-3" placeholder="Search units...">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="selectAll">
      <label class="form-check-label" for="selectAll">Select All (for deletion)</label>
    </div>
  </div>

  <!-- Show form errors -->
  {% if formset.non_form_errors %}
    <div class="alert alert-danger">
      {{ formset.non_form_errors }}
    </div>
  {% endif %}

  <form method="post" novalidate>
    {% csrf_token %}
    {{ formset.management_form }}

    <div class="table-responsive">
      <table class="table table-bordered align-middle table-sm">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Eircode</th>
            <th>Street</th>
            <th>City</th>
            <th>County</th>
            <th>Contact Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Delete?</th>
          </tr>
        </thead>
        <tbody>
          {% for form in formset %}
          <tr class="unit-row">
            {{ form.id }}
            <td>{{ form.name }}</td>
            <td>{{ form.unit_type }}</td>
            <td>{{ form.eircode }}</td>
            <td>{{ form.street }}</td>
            <td>{{ form.city }}</td>
            <td>{{ form.county }}</td>
            <td>{{ form.unit_contact_name }}</td>
            <td>{{ form.unit_contact_email }}</td>
            <td>{{ form.unit_contact_number }}</td>
            <td class="text-center">{{ form.DELETE }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Buttons -->
    <div class="d-flex justify-content-between mt-3">
      <a href="{% url 'manage_clients' %}" class="btn btn-secondary">Cancel</a>
      <div class="d-flex justify-content-between">
        <button type="submit" name="action" value="save" class="btn btn-success">Save Changes</button>
        <button type="submit" name="action" value="delete" class="btn btn-danger">Delete Selected Units</button>
      </div>
    </div>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/edit_units.js' %}"></script>
{% endblock %}
